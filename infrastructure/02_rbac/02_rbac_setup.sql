-- ============================================================
-- MEDICORE HEALTH SYSTEMS - SNOWFLAKE DATA PLATFORM
-- ============================================================
-- Phase 02: RBAC Setup
-- Script: 02_rbac_setup.sql
-- Version: 2.0.0
--
-- Change Reason: Added MEDICORE_SVC_GITHUB_ACTIONS role (Tier 9).
--               Removed MEDICORE_SECURITY_ADMIN (not required —
--               covered by MEDICORE_PLATFORM_ADMIN and
--               MEDICORE_COMPLIANCE_OFFICER). Updated all database
--               references to MEDICORE_ prefix. Added database
--               USAGE grants, schema USAGE grants, and future
--               grants for all roles across all DEV/QA/PROD
--               environment schemas. Role count updated to 18.
--
-- Description:
--   Creates the complete role-based access control hierarchy for
--   MediCore Health Systems. Implements 18 custom roles across 9
--   tiers following the approved RBAC design document. Establishes
--   role inheritance, database and schema grants, future grants,
--   and connects to Snowflake system roles.
--
-- Execution Requirements:
--   - Must be run as ACCOUNTADMIN initially
--   - Script transitions to SECURITYADMIN for role grants
--   - Execute statements sequentially from top to bottom
--   - Estimated execution time: 5-8 minutes
--
-- Dependencies:
--   - Phase 01 must be completed first
--   - MEDICORE_GOVERNANCE_DB must exist
--   - MEDICORE_GOVERNANCE_DB.SECURITY must exist
--   - MEDICORE_PASSWORD_POLICY must exist (for service account)
--   - Phase 03 must be completed before warehouse grants work
--   - Phase 04 must be completed before schema grants take effect
--
-- !! WARNING !!
--   Role hierarchy changes affect ALL users and warehouse access.
--   Review all grants carefully before execution in production.
--   Incorrect grants can expose PHI or lock out legitimate users.
--
-- Author: [YOUR_NAME]
-- Date: [YYYY-MM-DD]
-- ============================================================


-- ============================================================
-- SECTION 1: EXECUTION CONTEXT
-- ============================================================

USE ROLE ACCOUNTADMIN;


-- ============================================================
-- SECTION 2: CUSTOM ROLE CREATION
-- ============================================================
-- Creating 18 custom roles organized by tier as defined in
-- the approved RBAC design document (rbac-design.md)
-- ============================================================

-- ------------------------------------------------------------
-- TIER 1: ADMINISTRATIVE ROLES (1 role)
-- Platform administration - no direct PHI access
-- ------------------------------------------------------------

CREATE ROLE IF NOT EXISTS MEDICORE_PLATFORM_ADMIN
    COMMENT = 'Platform administrator for Snowflake account management. Manages warehouses, network policies, account settings, and governance objects. Cannot directly query PHI data. Persona: Hospital IT Director, Cloud Infrastructure Team.';

-- ------------------------------------------------------------
-- TIER 2: DATA ENGINEERING ROLES (2 roles)
-- Pipeline development and ETL operations
-- ------------------------------------------------------------

CREATE ROLE IF NOT EXISTS MEDICORE_DATA_ENGINEER
    COMMENT = 'Data pipeline developers with full MEDICORE_RAW_DB and MEDICORE_TRANSFORM_DB access. Can read MEDICORE_ANALYTICS_DB and MEDICORE_AI_READY_DB. Cannot manage security policies. Persona: Data Engineers, ETL Developers, Integration Specialists.';

CREATE ROLE IF NOT EXISTS MEDICORE_SVC_ETL_LOADER
    COMMENT = 'Service account role for automated ETL pipelines. Write-only to designated pipeline schemas. No interactive access. Isolated from human user roles. Persona: Airflow, dbt, Fivetran service connections.';

-- ------------------------------------------------------------
-- TIER 3: CLINICAL ROLES (3 roles)
-- Patient care and clinical data access
-- ------------------------------------------------------------

CREATE ROLE IF NOT EXISTS MEDICORE_CLINICAL_PHYSICIAN
    COMMENT = 'Attending physicians with full clinical PHI access for patient care. Access to encounters, diagnoses, medications, labs. HIPAA Treatment exception applies. Persona: Attending Physicians, Medical Directors, CMO.';

CREATE ROLE IF NOT EXISTS MEDICORE_CLINICAL_NURSE
    COMMENT = 'Nursing staff with unit-restricted clinical access. Financial identifiers masked. 42 CFR Part 2 records require consent. Persona: RNs, LPNs, Nurse Practitioners, Care Coordinators.';

CREATE ROLE IF NOT EXISTS MEDICORE_CLINICAL_READER
    COMMENT = 'Read-only clinical access for support staff. Limited to patient name and MRN only. All other PHI masked. Persona: Medical Assistants, Unit Clerks, Schedulers.';

-- ------------------------------------------------------------
-- TIER 4: REVENUE CYCLE ROLES (2 roles)
-- Billing, coding, and claims operations
-- ------------------------------------------------------------

CREATE ROLE IF NOT EXISTS MEDICORE_BILLING_SPECIALIST
    COMMENT = 'Billing and coding staff with access to charges, claims, and diagnosis codes. Clinical notes masked. Cannot access 42 CFR Part 2 records. Persona: Medical Coders, Billing Representatives, Revenue Cycle Analysts.';

CREATE ROLE IF NOT EXISTS MEDICORE_BILLING_READER
    COMMENT = 'Read-only billing data for financial reporting. Aggregated views only, no patient-level detail. Persona: Revenue Cycle Managers, Financial Analysts.';

-- ------------------------------------------------------------
-- TIER 5: ANALYTICS ROLES (3 roles)
-- Data analysis and machine learning
-- ------------------------------------------------------------

CREATE ROLE IF NOT EXISTS MEDICORE_ANALYST_PHI
    COMMENT = 'Clinical data analysts with PHI access for quality and outcomes research. Patient-level data allowed. HIPAA Operations exception applies. Persona: Clinical Data Analysts, Quality Improvement Specialists, Population Health Analysts.';

CREATE ROLE IF NOT EXISTS MEDICORE_ANALYST_RESTRICTED
    COMMENT = 'Business analysts with de-identified data only. No PHI access. Aggregated and de-identified datasets only. Persona: Business Intelligence Analysts, Report Developers, Operations Analysts.';

CREATE ROLE IF NOT EXISTS MEDICORE_DATA_SCIENTIST
    COMMENT = 'ML/AI practitioners with full MEDICORE_AI_READY_DB access. Can read MEDICORE_ANALYTICS_DB and MEDICORE_TRANSFORM_DB. Model deployment requires Platform Admin approval. Persona: Data Scientists, ML Engineers, AI Researchers.';

-- ------------------------------------------------------------
-- TIER 6: COMPLIANCE & AUDIT ROLES (2 roles)
-- Regulatory compliance and external auditing
-- ------------------------------------------------------------

CREATE ROLE IF NOT EXISTS MEDICORE_COMPLIANCE_OFFICER
    COMMENT = 'Compliance monitoring with full read access everywhere including audit logs. Manages masking policies, tags, and row access policies. Cannot modify pipeline data or configurations. Persona: Compliance Officers, Privacy Officers, Internal Auditors.';

CREATE ROLE IF NOT EXISTS MEDICORE_EXT_AUDITOR
    COMMENT = 'External auditor with time-limited, heavily restricted access. Pre-staged extracts only, all PHI masked. Access expires automatically. Persona: External CPA Firms, HITRUST Assessors, OCR Investigators.';

-- ------------------------------------------------------------
-- TIER 7: EXECUTIVE & BASE ROLES (2 roles)
-- Executive dashboards and foundation access
-- ------------------------------------------------------------

CREATE ROLE IF NOT EXISTS MEDICORE_EXECUTIVE
    COMMENT = 'Executive dashboards with aggregated KPIs only. No patient-level data access. No PHI exposure. Persona: CEO, CFO, COO, Board Members.';

CREATE ROLE IF NOT EXISTS MEDICORE_REFERENCE_READER
    COMMENT = 'Base role with reference/lookup data only. ICD-10 codes, CPT codes, facility master, department master. No PHI. Foundation role for all authenticated users.';

-- ------------------------------------------------------------
-- TIER 8: APPLICATION ROLES (1 role)
-- Streamlit and application service accounts
-- ------------------------------------------------------------

CREATE ROLE IF NOT EXISTS MEDICORE_APP_STREAMLIT
    COMMENT = 'Service role for Streamlit applications running in Snowflake. Inherits from configured role at deployment. Uses CURRENT_ROLE() of invoking user for row access policies.';

-- ------------------------------------------------------------
-- TIER 9: CI/CD SERVICE ROLES (1 role)
-- GitHub Actions and deployment automation
-- ------------------------------------------------------------

CREATE ROLE IF NOT EXISTS MEDICORE_SVC_GITHUB_ACTIONS
    COMMENT = 'Service account role used exclusively by GitHub Actions CI/CD pipelines via Schemachange. Has USAGE and CREATE privileges on all DEV, QA, and PROD schemas across all 4 layer databases. Uses MEDICORE_ETL_WH for deployments. Persona: GitHub Actions automation, Schemachange migration runner.';

-- VERIFICATION: All 18 roles created
SHOW ROLES LIKE 'MEDICORE%';


-- ============================================================
-- SECTION 3: ROLE HIERARCHY GRANTS
-- ============================================================
-- Implementing role inheritance as defined in the hierarchy
-- diagram. Child roles are granted TO parent roles, meaning
-- parent roles inherit all privileges from child roles.
-- Direction: GRANT ROLE child TO ROLE parent
-- ============================================================

USE ROLE SECURITYADMIN;

-- ------------------------------------------------------------
-- BASE TIER: REFERENCE_READER -> all data access roles
-- ------------------------------------------------------------

GRANT ROLE MEDICORE_REFERENCE_READER TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT ROLE MEDICORE_REFERENCE_READER TO ROLE MEDICORE_CLINICAL_READER;
GRANT ROLE MEDICORE_REFERENCE_READER TO ROLE MEDICORE_BILLING_READER;

-- ------------------------------------------------------------
-- CLINICAL HIERARCHY: READER -> NURSE -> PHYSICIAN
-- ------------------------------------------------------------

GRANT ROLE MEDICORE_CLINICAL_READER TO ROLE MEDICORE_CLINICAL_NURSE;
GRANT ROLE MEDICORE_CLINICAL_NURSE TO ROLE MEDICORE_CLINICAL_PHYSICIAN;

-- ------------------------------------------------------------
-- BILLING HIERARCHY: READER -> SPECIALIST
-- ------------------------------------------------------------

GRANT ROLE MEDICORE_BILLING_READER TO ROLE MEDICORE_BILLING_SPECIALIST;

-- ------------------------------------------------------------
-- ANALYTICS HIERARCHY: RESTRICTED -> PHI -> ENGINEER/SCIENTIST
-- ------------------------------------------------------------

GRANT ROLE MEDICORE_ANALYST_RESTRICTED TO ROLE MEDICORE_ANALYST_PHI;
GRANT ROLE MEDICORE_ANALYST_PHI TO ROLE MEDICORE_DATA_ENGINEER;
GRANT ROLE MEDICORE_ANALYST_PHI TO ROLE MEDICORE_DATA_SCIENTIST;

-- ------------------------------------------------------------
-- EXECUTIVE HIERARCHY: RESTRICTED -> EXECUTIVE
-- ------------------------------------------------------------

GRANT ROLE MEDICORE_ANALYST_RESTRICTED TO ROLE MEDICORE_EXECUTIVE;

-- ------------------------------------------------------------
-- COMPLIANCE HIERARCHY: PHI -> COMPLIANCE_OFFICER
-- ------------------------------------------------------------

GRANT ROLE MEDICORE_ANALYST_PHI TO ROLE MEDICORE_COMPLIANCE_OFFICER;

-- ------------------------------------------------------------
-- STANDALONE ROLES (No inheritance - isolated by design)
-- ------------------------------------------------------------
-- MEDICORE_SVC_ETL_LOADER    : Standalone, minimal privileges, service account only
-- MEDICORE_EXT_AUDITOR       : Standalone, time-limited, pre-staged views only
-- MEDICORE_APP_STREAMLIT     : Standalone, inherits at runtime from invoking user
-- MEDICORE_SVC_GITHUB_ACTIONS: Standalone, CI/CD automation service account only

-- VERIFICATION: Role hierarchy established
SHOW GRANTS OF ROLE MEDICORE_REFERENCE_READER;
SHOW GRANTS OF ROLE MEDICORE_ANALYST_RESTRICTED;
SHOW GRANTS OF ROLE MEDICORE_ANALYST_PHI;
SHOW GRANTS OF ROLE MEDICORE_CLINICAL_READER;
SHOW GRANTS OF ROLE MEDICORE_BILLING_READER;


-- ============================================================
-- SECTION 4: GRANT ROLES TO SNOWFLAKE SYSTEM ROLES
-- ============================================================

USE ROLE ACCOUNTADMIN;

-- PLATFORM_ADMIN reports to SYSADMIN for database/warehouse management
GRANT ROLE MEDICORE_PLATFORM_ADMIN TO ROLE SYSADMIN;

-- Top-level data roles to SYSADMIN
GRANT ROLE MEDICORE_DATA_ENGINEER TO ROLE SYSADMIN;
GRANT ROLE MEDICORE_SVC_ETL_LOADER TO ROLE SYSADMIN;
GRANT ROLE MEDICORE_CLINICAL_PHYSICIAN TO ROLE SYSADMIN;
GRANT ROLE MEDICORE_BILLING_SPECIALIST TO ROLE SYSADMIN;
GRANT ROLE MEDICORE_DATA_SCIENTIST TO ROLE SYSADMIN;
GRANT ROLE MEDICORE_COMPLIANCE_OFFICER TO ROLE SYSADMIN;
GRANT ROLE MEDICORE_EXECUTIVE TO ROLE SYSADMIN;
GRANT ROLE MEDICORE_EXT_AUDITOR TO ROLE SYSADMIN;
GRANT ROLE MEDICORE_APP_STREAMLIT TO ROLE SYSADMIN;
GRANT ROLE MEDICORE_SVC_GITHUB_ACTIONS TO ROLE SYSADMIN;

-- VERIFICATION: System role connections
SHOW GRANTS TO ROLE SYSADMIN;


-- ============================================================
-- SECTION 5: SERVICE ACCOUNT USER SETUP
-- ============================================================

USE ROLE SECURITYADMIN;

-- ETL service account - created DISABLED until key-pair auth configured
CREATE USER IF NOT EXISTS SVC_ETL_MEDICORE
    DEFAULT_ROLE = MEDICORE_SVC_ETL_LOADER
    DEFAULT_WAREHOUSE = NULL
    DISABLED = TRUE
    COMMENT = 'Service account for MediCore ETL pipelines. Created DISABLED until key-pair authentication is configured. Do not enable with password auth. Post-step: Configure RSA key pair then ALTER USER SVC_ETL_MEDICORE SET DISABLED = FALSE.';

GRANT ROLE MEDICORE_SVC_ETL_LOADER TO USER SVC_ETL_MEDICORE;

-- GitHub Actions service account - created DISABLED until key-pair auth configured
CREATE USER IF NOT EXISTS SVC_GITHUB_ACTIONS_MEDICORE
    DEFAULT_ROLE = MEDICORE_SVC_GITHUB_ACTIONS
    DEFAULT_WAREHOUSE = MEDICORE_ETL_WH
    DISABLED = TRUE
    COMMENT = 'Service account for GitHub Actions CI/CD pipelines. Created DISABLED until key-pair authentication is configured. Do not enable with password auth. Post-step: Configure RSA key pair then ALTER USER SVC_GITHUB_ACTIONS_MEDICORE SET DISABLED = FALSE.';

GRANT ROLE MEDICORE_SVC_GITHUB_ACTIONS TO USER SVC_GITHUB_ACTIONS_MEDICORE;

-- VERIFICATION: Service accounts created
SHOW USERS LIKE 'SVC%';


-- ============================================================
-- SECTION 6: MEDICORE_GOVERNANCE_DB GRANTS
-- ============================================================
-- Governance database is environment-agnostic.
-- SECURITY schema was created in Phase 01.
-- POLICIES, TAGS, DATA_QUALITY, AUDIT schemas created in Phase 04.
-- Grants here cover USAGE on the database and all schemas.
-- ============================================================

USE ROLE ACCOUNTADMIN;

-- PLATFORM_ADMIN: Full governance access for account management
GRANT USAGE ON DATABASE MEDICORE_GOVERNANCE_DB TO ROLE MEDICORE_PLATFORM_ADMIN;
GRANT USAGE ON SCHEMA MEDICORE_GOVERNANCE_DB.SECURITY TO ROLE MEDICORE_PLATFORM_ADMIN;

-- DATA_ENGINEER: Governance access for pipeline development
GRANT USAGE ON DATABASE MEDICORE_GOVERNANCE_DB TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_GOVERNANCE_DB.SECURITY TO ROLE MEDICORE_DATA_ENGINEER;

-- COMPLIANCE_OFFICER: Full governance read access for audit and policy verification
GRANT USAGE ON DATABASE MEDICORE_GOVERNANCE_DB TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_GOVERNANCE_DB.SECURITY TO ROLE MEDICORE_COMPLIANCE_OFFICER;

-- SVC_GITHUB_ACTIONS: Governance database usage for deployment context
GRANT USAGE ON DATABASE MEDICORE_GOVERNANCE_DB TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_GOVERNANCE_DB.SECURITY TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- NOTE: POLICIES, TAGS, DATA_QUALITY, AUDIT schema grants added in Phase 04
-- after those schemas are created.


-- ============================================================
-- SECTION 7: MEDICORE_RAW_DB GRANTS
-- ============================================================
-- Bronze layer. Most restrictive — engineering and compliance only.
-- ETL_LOADER needs INSERT/UPDATE. COMPLIANCE needs SELECT for audit.
-- NOTE: These grants take effect after Phase 04 creates the databases.
-- ============================================================

USE ROLE ACCOUNTADMIN;

-- ------------------------------------------------------------
-- MEDICORE_RAW_DB — DATABASE USAGE GRANTS
-- ------------------------------------------------------------

GRANT USAGE ON DATABASE MEDICORE_RAW_DB TO ROLE MEDICORE_PLATFORM_ADMIN;
GRANT USAGE ON DATABASE MEDICORE_RAW_DB TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON DATABASE MEDICORE_RAW_DB TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON DATABASE MEDICORE_RAW_DB TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON DATABASE MEDICORE_RAW_DB TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_RAW_DB — CREATE SCHEMA PRIVILEGE
-- Data Engineers need to create new schemas for pipeline development
-- ------------------------------------------------------------

GRANT CREATE SCHEMA ON DATABASE MEDICORE_RAW_DB TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE SCHEMA ON DATABASE MEDICORE_RAW_DB TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT CREATE SCHEMA ON DATABASE MEDICORE_RAW_DB TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_RAW_DB — SCHEMA USAGE GRANTS (PROD)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.PROD_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;

-- ------------------------------------------------------------
-- MEDICORE_RAW_DB — SCHEMA USAGE GRANTS (QA)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.QA_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_RAW_DB — SCHEMA USAGE GRANTS (DEV)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_RAW_DB — FUTURE GRANTS (PROD)
-- ------------------------------------------------------------

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.PROD_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;

-- ------------------------------------------------------------
-- MEDICORE_RAW_DB — FUTURE GRANTS (QA)
-- ------------------------------------------------------------

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.QA_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_RAW_DB — FUTURE GRANTS (DEV)
-- ------------------------------------------------------------

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT INSERT, UPDATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;


-- ============================================================
-- SECTION 8: MEDICORE_TRANSFORM_DB GRANTS
-- ============================================================
-- Silver layer. Engineering, data science, and compliance access.
-- DATA_ENGINEER needs full DDL and DML on DEV/QA for pipeline development.
-- ============================================================

USE ROLE ACCOUNTADMIN;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — DATABASE USAGE GRANTS
-- ------------------------------------------------------------

GRANT USAGE ON DATABASE MEDICORE_TRANSFORM_DB TO ROLE MEDICORE_PLATFORM_ADMIN;
GRANT USAGE ON DATABASE MEDICORE_TRANSFORM_DB TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON DATABASE MEDICORE_TRANSFORM_DB TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON DATABASE MEDICORE_TRANSFORM_DB TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON DATABASE MEDICORE_TRANSFORM_DB TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON DATABASE MEDICORE_TRANSFORM_DB TO ROLE MEDICORE_SVC_ETL_LOADER;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — CREATE SCHEMA PRIVILEGE
-- Data Engineers need to create new schemas for pipeline development
-- ------------------------------------------------------------

GRANT CREATE SCHEMA ON DATABASE MEDICORE_TRANSFORM_DB TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE SCHEMA ON DATABASE MEDICORE_TRANSFORM_DB TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT CREATE SCHEMA ON DATABASE MEDICORE_TRANSFORM_DB TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — SCHEMA USAGE GRANTS (PROD)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_AUDIT TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_COMMON TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_COMMON TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_COMMON TO ROLE MEDICORE_COMPLIANCE_OFFICER;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — SCHEMA USAGE GRANTS (QA)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_SVC_ETL_LOADER;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — SCHEMA USAGE GRANTS (DEV)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT USAGE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_SVC_ETL_LOADER;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — CREATE PRIVILEGES FOR DATA_ENGINEER (DEV/QA)
-- Data Engineers need full DDL on DEV and QA for pipeline development
-- ------------------------------------------------------------

-- DEV schemas - Full DDL for development
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_DATA_ENGINEER;

-- QA schemas - Full DDL for testing
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_DATA_ENGINEER;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — FUTURE GRANTS (PROD)
-- ------------------------------------------------------------

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_COMMON TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_COMMON TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_COMMON TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.PROD_COMMON TO ROLE MEDICORE_DATA_SCIENTIST;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — FUTURE GRANTS (QA)
-- ------------------------------------------------------------

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_DATA_SCIENTIST;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — FUTURE GRANTS (DEV)
-- ------------------------------------------------------------

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_DATA_SCIENTIST;


-- ============================================================
-- SECTION 9: MEDICORE_ANALYTICS_DB GRANTS
-- ============================================================
-- Gold layer. Broadest access. Masking and row access policies
-- enforced in Phase 08. Dynamic Tables powered by Phase 11.
-- ============================================================

USE ROLE ACCOUNTADMIN;

-- ------------------------------------------------------------
-- MEDICORE_ANALYTICS_DB — DATABASE USAGE GRANTS
-- ------------------------------------------------------------

GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_PLATFORM_ADMIN;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_CLINICAL_PHYSICIAN;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_CLINICAL_NURSE;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_CLINICAL_READER;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_BILLING_SPECIALIST;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_BILLING_READER;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_EXECUTIVE;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_EXT_AUDITOR;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_APP_STREAMLIT;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_REFERENCE_READER;
GRANT USAGE ON DATABASE MEDICORE_ANALYTICS_DB TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_ANALYTICS_DB — SCHEMA USAGE GRANTS (PROD)
-- ------------------------------------------------------------

-- PROD_CLINICAL: Clinical roles, analysts, compliance, data scientist, app
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_PHYSICIAN;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_NURSE;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_READER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_APP_STREAMLIT;

-- PROD_BILLING: Billing roles, analysts, compliance, data scientist, app
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_BILLING_SPECIALIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_BILLING_READER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_APP_STREAMLIT;

-- PROD_REFERENCE: All roles via REFERENCE_READER inheritance
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_REFERENCE_READER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;

-- PROD_EXECUTIVE: Executive, restricted analysts, compliance, app
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_EXECUTIVE;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_APP_STREAMLIT;

-- PROD_DEIDENTIFIED: Restricted analysts, external auditor, compliance, data scientist
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_EXT_AUDITOR;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_DATA_SCIENTIST;

-- ------------------------------------------------------------
-- MEDICORE_ANALYTICS_DB — SCHEMA USAGE GRANTS (QA)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_REFERENCE_READER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_EXECUTIVE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_EXECUTIVE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_EXECUTIVE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_ANALYTICS_DB — SCHEMA USAGE GRANTS (DEV)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_REFERENCE_READER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_EXECUTIVE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_EXECUTIVE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_EXECUTIVE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_ANALYTICS_DB — CREATE PRIVILEGES FOR DATA_ENGINEER (DEV/QA)
-- Data Engineers need full DDL on DEV and QA for pipeline development
-- ------------------------------------------------------------

-- DEV schemas - Full DDL for development
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_EXECUTIVE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_DATA_ENGINEER;

-- QA schemas - Full DDL for testing
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_EXECUTIVE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_DATA_ENGINEER;

-- ------------------------------------------------------------
-- MEDICORE_ANALYTICS_DB — FUTURE GRANTS (PROD)
-- ------------------------------------------------------------

-- PROD_CLINICAL future grants
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_PHYSICIAN;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_NURSE;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_READER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_APP_STREAMLIT;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_PHYSICIAN;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_NURSE;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_READER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_PHYSICIAN;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_NURSE;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_CLINICAL_READER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_APP_STREAMLIT;

-- PROD_BILLING future grants
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_BILLING_SPECIALIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_BILLING_READER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_APP_STREAMLIT;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_BILLING_SPECIALIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_BILLING_READER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_BILLING_SPECIALIST;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_BILLING_READER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_APP_STREAMLIT;

-- PROD_REFERENCE future grants
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_REFERENCE_READER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_REFERENCE_READER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_REFERENCE_READER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_DATA_SCIENTIST;

-- PROD_EXECUTIVE future grants
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_EXECUTIVE;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_APP_STREAMLIT;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_EXECUTIVE;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_EXECUTIVE;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_APP_STREAMLIT;

-- PROD_DEIDENTIFIED future grants
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_EXT_AUDITOR;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_EXT_AUDITOR;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_EXT_AUDITOR;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_ANALYST_RESTRICTED;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_DATA_SCIENTIST;

-- ------------------------------------------------------------
-- MEDICORE_ANALYTICS_DB — FUTURE GRANTS (QA and DEV)
-- QA and DEV are primarily for engineering validation
-- ------------------------------------------------------------

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_EXECUTIVE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_EXECUTIVE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_EXECUTIVE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_EXECUTIVE TO ROLE MEDICORE_DATA_ENGINEER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_DATA_SCIENTIST;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_EXECUTIVE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_EXECUTIVE TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_EXECUTIVE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT SELECT ON FUTURE DYNAMIC TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_EXECUTIVE TO ROLE MEDICORE_DATA_ENGINEER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;


-- ============================================================
-- SECTION 10: MEDICORE_AI_READY_DB GRANTS
-- ============================================================
-- Platinum layer. Restricted to ML and advanced analytics roles.
-- Domains are FEATURES, TRAINING, SEMANTIC, EMBEDDINGS.
-- ============================================================

USE ROLE ACCOUNTADMIN;

-- ------------------------------------------------------------
-- MEDICORE_AI_READY_DB — DATABASE USAGE GRANTS
-- ------------------------------------------------------------

GRANT USAGE ON DATABASE MEDICORE_AI_READY_DB TO ROLE MEDICORE_PLATFORM_ADMIN;
GRANT USAGE ON DATABASE MEDICORE_AI_READY_DB TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON DATABASE MEDICORE_AI_READY_DB TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON DATABASE MEDICORE_AI_READY_DB TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON DATABASE MEDICORE_AI_READY_DB TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON DATABASE MEDICORE_AI_READY_DB TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_AI_READY_DB — SCHEMA USAGE GRANTS (PROD)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_SEMANTIC TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_SEMANTIC TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_SEMANTIC TO ROLE MEDICORE_COMPLIANCE_OFFICER;

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_COMPLIANCE_OFFICER;

-- ------------------------------------------------------------
-- MEDICORE_AI_READY_DB — SCHEMA USAGE GRANTS (QA)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_FEATURES TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_FEATURES TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_FEATURES TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_FEATURES TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_FEATURES TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_TRAINING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_TRAINING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_TRAINING TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_TRAINING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_TRAINING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_SEMANTIC TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_SEMANTIC TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_SEMANTIC TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_SEMANTIC TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_EMBEDDINGS TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_EMBEDDINGS TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_EMBEDDINGS TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_EMBEDDINGS TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.QA_EMBEDDINGS TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_AI_READY_DB — SCHEMA USAGE GRANTS (DEV)
-- ------------------------------------------------------------

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_FEATURES TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_FEATURES TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_FEATURES TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_FEATURES TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_FEATURES TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_TRAINING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_TRAINING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_TRAINING TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_TRAINING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_TRAINING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_SEMANTIC TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_SEMANTIC TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_SEMANTIC TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_SEMANTIC TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_EMBEDDINGS TO ROLE MEDICORE_DATA_ENGINEER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_EMBEDDINGS TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_EMBEDDINGS TO ROLE MEDICORE_ANALYST_PHI;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_EMBEDDINGS TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT USAGE ON SCHEMA MEDICORE_AI_READY_DB.DEV_EMBEDDINGS TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- ------------------------------------------------------------
-- MEDICORE_AI_READY_DB — FUTURE GRANTS (PROD)
-- ------------------------------------------------------------

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_DATA_ENGINEER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_DATA_ENGINEER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_SEMANTIC TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_SEMANTIC TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_SEMANTIC TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_AI_READY_DB.PROD_SEMANTIC TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_AI_READY_DB.PROD_SEMANTIC TO ROLE MEDICORE_DATA_ENGINEER;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_ANALYST_PHI;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_COMPLIANCE_OFFICER;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE VIEWS IN SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_DATA_ENGINEER;

-- ------------------------------------------------------------
-- MEDICORE_AI_READY_DB — FUTURE GRANTS (QA and DEV)
-- ------------------------------------------------------------

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_FEATURES TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_FEATURES TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_FEATURES TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_TRAINING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_TRAINING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_TRAINING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_SEMANTIC TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_SEMANTIC TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_SEMANTIC TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_EMBEDDINGS TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_EMBEDDINGS TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.QA_EMBEDDINGS TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_FEATURES TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_FEATURES TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_FEATURES TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_TRAINING TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_TRAINING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_TRAINING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_SEMANTIC TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_SEMANTIC TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_SEMANTIC TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_EMBEDDINGS TO ROLE MEDICORE_DATA_SCIENTIST;
GRANT SELECT ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_EMBEDDINGS TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE ON FUTURE TABLES IN SCHEMA MEDICORE_AI_READY_DB.DEV_EMBEDDINGS TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;


-- ============================================================
-- SECTION 11: MEDICORE_SVC_GITHUB_ACTIONS — CREATE PRIVILEGES
-- ============================================================
-- CI/CD role needs CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE
-- on all DEV, QA, and PROD schemas across all 4 layer databases
-- to deploy migration scripts via Schemachange.
-- ============================================================

USE ROLE ACCOUNTADMIN;

-- MEDICORE_RAW_DB CREATE privileges
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.PROD_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.PROD_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.PROD_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.PROD_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.QA_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.QA_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- MEDICORE_TRANSFORM_DB CREATE privileges
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.PROD_COMMON TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- MEDICORE_ANALYTICS_DB CREATE privileges
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_EXECUTIVE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.PROD_DEIDENTIFIED TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_EXECUTIVE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.QA_DEIDENTIFIED TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_BILLING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_EXECUTIVE TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW, CREATE DYNAMIC TABLE ON SCHEMA MEDICORE_ANALYTICS_DB.DEV_DEIDENTIFIED TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- MEDICORE_AI_READY_DB CREATE privileges
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.PROD_FEATURES TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.PROD_TRAINING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.PROD_SEMANTIC TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.PROD_EMBEDDINGS TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.QA_FEATURES TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.QA_TRAINING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.QA_SEMANTIC TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.QA_EMBEDDINGS TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.DEV_FEATURES TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.DEV_TRAINING TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.DEV_SEMANTIC TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT CREATE TABLE, CREATE VIEW ON SCHEMA MEDICORE_AI_READY_DB.DEV_EMBEDDINGS TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;


-- ============================================================
-- SECTION 11B: DML PRIVILEGES FOR DATA_ENGINEER & SVC_ETL_LOADER
-- ============================================================
-- Data Engineers need full DML (SELECT, INSERT, UPDATE, DELETE, TRUNCATE)
-- on DEV/QA schemas for development and testing.
-- SVC_ETL_LOADER needs DML for automated ETL pipelines.
-- ============================================================

USE ROLE ACCOUNTADMIN;

-- ------------------------------------------------------------
-- MEDICORE_RAW_DB — DML GRANTS FOR DEV SCHEMAS
-- ------------------------------------------------------------

-- DATA_ENGINEER: Full DML on DEV RAW schemas
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;

-- Future grants for DEV RAW
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;

-- SVC_ETL_LOADER: Full DML on DEV RAW schemas
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_RAW_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — DML GRANTS FOR DEV SCHEMAS
-- ------------------------------------------------------------

-- DATA_ENGINEER: Full DML on DEV TRANSFORM schemas
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_DATA_ENGINEER;

-- Future grants for DEV TRANSFORM
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_DATA_ENGINEER;

-- SVC_ETL_LOADER: Full DML on DEV TRANSFORM schemas
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.DEV_COMMON TO ROLE MEDICORE_SVC_ETL_LOADER;

-- ------------------------------------------------------------
-- MEDICORE_TRANSFORM_DB — DML GRANTS FOR QA SCHEMAS
-- ------------------------------------------------------------

-- DATA_ENGINEER: Full DML on QA TRANSFORM schemas
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_DATA_ENGINEER;

-- Future grants for QA TRANSFORM
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_DATA_ENGINEER;

-- SVC_ETL_LOADER: Full DML on QA TRANSFORM schemas
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON ALL TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_SVC_ETL_LOADER;

GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_CLINICAL TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_BILLING TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_REFERENCE TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_AUDIT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT SELECT, INSERT, UPDATE, DELETE, TRUNCATE ON FUTURE TABLES IN SCHEMA MEDICORE_TRANSFORM_DB.QA_COMMON TO ROLE MEDICORE_SVC_ETL_LOADER;

-- ------------------------------------------------------------
-- MEDICORE_GOVERNANCE_DB — TAG USAGE FOR TAGGING OPERATIONS
-- ------------------------------------------------------------

-- DATA_ENGINEER needs APPLY TAG privilege for governance tagging
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.MEDALLION_LAYER TO ROLE MEDICORE_DATA_ENGINEER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.DATA_DOMAIN TO ROLE MEDICORE_DATA_ENGINEER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.ENVIRONMENT TO ROLE MEDICORE_DATA_ENGINEER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.PII_CLASSIFICATION TO ROLE MEDICORE_DATA_ENGINEER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.DATA_QUALITY_STATUS TO ROLE MEDICORE_DATA_ENGINEER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.DATA_OWNER TO ROLE MEDICORE_DATA_ENGINEER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.RETENTION_POLICY TO ROLE MEDICORE_DATA_ENGINEER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.COST_CENTER TO ROLE MEDICORE_DATA_ENGINEER;

-- SVC_ETL_LOADER also needs APPLY TAG for automated tagging
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.MEDALLION_LAYER TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.DATA_DOMAIN TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.ENVIRONMENT TO ROLE MEDICORE_SVC_ETL_LOADER;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.DATA_QUALITY_STATUS TO ROLE MEDICORE_SVC_ETL_LOADER;

-- SVC_GITHUB_ACTIONS needs APPLY TAG for CI/CD deployments
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.MEDALLION_LAYER TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.DATA_DOMAIN TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.ENVIRONMENT TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.PII_CLASSIFICATION TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.DATA_QUALITY_STATUS TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.DATA_OWNER TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.RETENTION_POLICY TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;
GRANT APPLY ON TAG MEDICORE_GOVERNANCE_DB.TAGS.COST_CENTER TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;


-- ============================================================
-- SECTION 12: COMPREHENSIVE VERIFICATION QUERIES
-- ============================================================

USE ROLE ACCOUNTADMIN;

-- Verify all 18 MEDICORE roles exist
SELECT COUNT(*) AS medicore_role_count
FROM SNOWFLAKE.ACCOUNT_USAGE.ROLES
WHERE NAME LIKE 'MEDICORE%'
AND DELETED_ON IS NULL;

-- List all MEDICORE roles with details
SHOW ROLES LIKE 'MEDICORE%';

-- Verify role hierarchy
SHOW GRANTS OF ROLE MEDICORE_REFERENCE_READER;
SHOW GRANTS OF ROLE MEDICORE_ANALYST_RESTRICTED;
SHOW GRANTS OF ROLE MEDICORE_ANALYST_PHI;
SHOW GRANTS OF ROLE MEDICORE_CLINICAL_READER;
SHOW GRANTS OF ROLE MEDICORE_BILLING_READER;

-- Verify system role connections
SHOW GRANTS TO ROLE SYSADMIN;

-- Verify service accounts
SHOW USERS LIKE 'SVC%';

-- Verify GitHub Actions role grants
SHOW GRANTS TO ROLE MEDICORE_SVC_GITHUB_ACTIONS;

-- Verify database grants for key roles
SHOW GRANTS TO ROLE MEDICORE_DATA_ENGINEER;
SHOW GRANTS TO ROLE MEDICORE_CLINICAL_PHYSICIAN;
SHOW GRANTS TO ROLE MEDICORE_COMPLIANCE_OFFICER;


-- ============================================================
-- SECTION 13: PHASE 02 SUMMARY
-- ============================================================
--
-- ROLES CREATED: 18
--   Tier 1 - Administrative:     MEDICORE_PLATFORM_ADMIN
--   Tier 2 - Data Engineering:   MEDICORE_DATA_ENGINEER
--                                MEDICORE_SVC_ETL_LOADER
--   Tier 3 - Clinical:           MEDICORE_CLINICAL_PHYSICIAN
--                                MEDICORE_CLINICAL_NURSE
--                                MEDICORE_CLINICAL_READER
--   Tier 4 - Revenue Cycle:      MEDICORE_BILLING_SPECIALIST
--                                MEDICORE_BILLING_READER
--   Tier 5 - Analytics:          MEDICORE_ANALYST_PHI
--                                MEDICORE_ANALYST_RESTRICTED
--                                MEDICORE_DATA_SCIENTIST
--   Tier 6 - Compliance:         MEDICORE_COMPLIANCE_OFFICER
--                                MEDICORE_EXT_AUDITOR
--   Tier 7 - Executive/Base:     MEDICORE_EXECUTIVE
--                                MEDICORE_REFERENCE_READER
--   Tier 8 - Application:        MEDICORE_APP_STREAMLIT
--   Tier 9 - CI/CD:              MEDICORE_SVC_GITHUB_ACTIONS
--
-- HIERARCHY GRANTS: 11
--   REFERENCE_READER  -> ANALYST_RESTRICTED
--   REFERENCE_READER  -> CLINICAL_READER
--   REFERENCE_READER  -> BILLING_READER
--   CLINICAL_READER   -> CLINICAL_NURSE
--   CLINICAL_NURSE    -> CLINICAL_PHYSICIAN
--   BILLING_READER    -> BILLING_SPECIALIST
--   ANALYST_RESTRICTED -> ANALYST_PHI
--   ANALYST_PHI       -> DATA_ENGINEER
--   ANALYST_PHI       -> DATA_SCIENTIST
--   ANALYST_RESTRICTED -> EXECUTIVE
--   ANALYST_PHI       -> COMPLIANCE_OFFICER
--
-- SYSTEM ROLE GRANTS: 12 to SYSADMIN
--
-- SERVICE ACCOUNTS CREATED: 2
--   SVC_ETL_MEDICORE              (DISABLED - requires key-pair auth)
--   SVC_GITHUB_ACTIONS_MEDICORE   (DISABLED - requires key-pair auth)
--
-- DATABASE GRANTS CONFIGURED: 5 databases
--   MEDICORE_GOVERNANCE_DB : 4 roles
--   MEDICORE_RAW_DB        : 5 roles
--   MEDICORE_TRANSFORM_DB  : 5 roles
--   MEDICORE_ANALYTICS_DB  : 16 roles
--   MEDICORE_AI_READY_DB   : 6 roles
--
-- SCHEMA GRANTS CONFIGURED: All DEV/QA/PROD schemas
--   Per role per schema following principle of least privilege
--
-- FUTURE GRANTS CONFIGURED: Tables, Views, Dynamic Tables
--   Per role per schema across all environments
--
-- NOTE: Database and schema grants in Sections 6-11 will return
--       errors if run before Phase 04 creates the databases.
--       Run Phase 03 and Phase 04 first, then re-run Sections
--       6-11 if needed, or run the full file after Phase 04.
--
-- PHASE 03 DEPENDENCIES:
--   - Roles exist for warehouse USAGE grants
--   - SVC_GITHUB_ACTIONS_MEDICORE user created for ETL_WH grant
--
-- PHASE 04 DEPENDENCIES:
--   - All database and schema grants reference objects created
--     in Phase 04. Sections 6-11 require Phase 04 completion.
--
-- ============================================================
-- END OF PHASE 02: RBAC SETUP
-- ============================================================